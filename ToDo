### Raspagem de notícias

As notícias a serem raspadas estarão disponíveis na aba de últimas notícias do TecMundo: https://www.tecmundo.com.br/novidades.

Essas notícias devem ser salvas no banco de dados, utilizando os mesmos atributos já descritos nas importações/exportações citadas anteriormente.

### MongoDB

Para a realização desse projeto, **sugere-se** que você crie um banco de dados, chamado `tech_news`, para a aplicação e um banco de dados separado, chamado `tech_news_test`, para o ambiente de testes. Dessa forma, ambos os ambientes estarão isolados, o que garante que os testes não poluirão sua base de dados.

Para garantir que os dados gerados para um teste não influencie em outro teste, você deve popular e deletar as coleções ao início e ao fim de cada teste, respectivamente.

_Dica:_ Utilize a função `drop` do mongo no final do teste.

---

## Requisitos obrigatórios:

### Pacote `tech_news_data_collector`

#### 1 - Deve haver uma função `scrape` dentro do módulo `news_scrapper` capaz de raspar as últimas notícias das N primeiras páginas, armazenando suas informações no banco de dados.

> Observação: Utilizar os seguintes atributos: `url`, `title`, `timestamp`, `writer`, `shares_count`, `comments_count`, `summary`, `sources` e `categories`. Notícias que já existirem no banco de dados devem ser atualizadas (verifique pela URL).

**Dica:** Caso uma tag possua outras tags aninhadas, para obter todos os textos da tag ancestral e de suas tags descendentes, utilize `*::text` no seletor.

**Exemplo:**

```html
<p>
    Recentemente, a Alemanha fez a
    <a
        href="https://www.tecmundo.com.br/mobilidade-urbana-smart-cities/155000-musk-tesla-carros-totalmente-autonomos.htm"
        rel="noopener noreferrer"
        target="_blank"
        >Tesla</a
    >
    “pisar no freio” quanto ao uso de termos comerciais relacionados a carros
    autônomos, mas quem pensa que esse é um sinal de resistência à introdução de
    novas tecnologias se engana. Isso porque, de acordo o
    <em>Automotive News Europe</em>, o país está se preparando para se tornar o
    primeiro do mundo a criar uma ampla estrutura para regulamentar tais
    veículos de nível 4.
</p>
```

Repare que no exemplo dentro da tag _p_ encontram-se duas outras tags. Esse é um caso onde a tag _p_ é um ancestral e as tags _a_ e _em_ são as descendentes. Para obter todo o texto do exemplo, utiliza-se `*::text` no seletor.

##### As seguintes verificações serão feitas:

<!--  -->





-   Ao finalizar o scrapping, deve-se exibir a mensagem "Raspagem de notícias finalizada".


### Pacote `tech_news_app`

#### 6 - Deve haver uma função `search_by_title` dentro do módulo `news_search_engine`, que busque as notícias do banco de dados por título (parcial ou completo) e exiba uma lista de notícias encontradas. Para cada notícia encontrada, deve-se listar seu título e link.

##### As seguintes verificações serão feitas:

-   A busca deve ser _case insensitive_ e deve retornar uma lista de notícias no formato `["- {title}: {url}"]`;

-   Caso nenhuma notícia seja encontrada, deve-se retornar uma lista vazia.

#### 7 - Deve haver uma função `search_by_date` dentro do módulo `news_search_engine`, que busque as notícias do banco de dados por data e exiba uma lista de notícias encontradas. Para cada notícia encontrada, deve-se listar seu título e link.

##### As seguintes verificações serão feitas:

-   A busca deve retornar uma lista de notícias no formato `["- {title}: {url}"]`;

-   A data deve estar no formato "aaaa-mm-dd" e deve ser válida. Caso seja inválida, deve-se exibir a mensagem "Data inválida";

-   Caso nenhuma notícia seja encontrada, deve-se retornar uma lista vazia.

#### 8 - Deve haver uma função `search_by_source` dentro do módulo `news_search_engine`, que busque as notícias do banco de dados por fonte (apenas uma por vez e com nome completo) e exiba uma lista de notícias encontradas. Para cada notícia encontrada, deve-se listar seu título e link.

##### As seguintes verificações serão feitas:

-   A busca deve ser _case insensitive_ e deve retornar uma lista de notícias no formato `["- {title}: {url}"]`;

-   Caso nenhuma notícia seja encontrada, deve-se retornar uma lista vazia.

#### 9 - Deve haver uma função `search_by_category` dentro do módulo `news_search_engine`, que busque as notícias do banco de dados por categoria (apenas uma por vez e com nome completo) e exiba uma lista de notícias encontradas. Para cada notícia encontrada, deve-se listar seu título e link.

##### As seguintes verificações serão feitas:

-   A busca deve ser _case insensitive_ e deve retornar uma lista de notícias no formato `["- {title}: {url}"]`;

-   Caso nenhuma notícia seja encontrada, deve-se retornar uma lista vazia.

#### 10 - Deve haver uma função `top_5_news` dentro do módulo `news_analyser`, que liste as cinco notícias com a maior soma de compartilhamentos e comentários do banco de dados. As notícias devem ser ordenadas pela popularidade. Em caso de empate, o desempate deve ser por ordem alfabética de título.

##### As seguintes verificações serão feitas:

-   As top 5 notícias da análise devem ser retornadas em uma lista de notícias no formato `["- {title}: {url}"]`;

-   Caso haja menos de cinco notícias, no banco de dados, deve-se retornar todas as notícias existentes;

-   Caso não haja notícias disponíveis, deve-se retornar uma lista vazia.

#### 11 - Deve haver uma função `top_5_categories` dentro do módulo `news_analyser`, que liste as cinco categorias com maior ocorrência no banco de dados. As categorias devem ser ordenadas por ordem alfabética.

##### As seguintes verificações serão feitas:

-   As top 5 categorias da análise devem ser retornadas em uma lista de categorias no formato `["- {category}"]`;

-   Caso haja menos de cinco categorias, no banco de dados, deve-se retornar todas as categorias existentes;

-   Caso não haja categorias disponíveis, deve-se retornar uma lista vazia.

---

## Requisitos bônus:

### Pacote `tech_news_data_collector`

#### 12 - Crie um módulo `news_data_collector_menu` que deve ser utilizado como um menu de opções, em que cada opção pede as informações necessárias para disparar uma ação. O texto exibido pelo menu deve ser exatamente:

**Dica**: Utilize o `__main__`.

```md
Selecione uma das opções a seguir:

1 - Importar notícias a partir de um arquivo CSV;
2 - Exportar notícias para CSV;
3 - Importar notícias a partir de um arquivo JSON;
4 - Exportar notícias para JSON;
5 - Raspar notícias online;
6 - Sair.
```

##### As seguintes verificações serão feitas:

-   A mensagem de menu deve ser exibida corretamente;

-   Caso a opção `1` seja selecionada, deve-se exibir a mensagem "Digite o path do arquivo CSV a ser importado:";

-   Caso a opção `2` seja selecionada, deve-se exibir a mensagem "Digite o nome do arquivo CSV a ser exportado:";

-   Caso a opção `3` seja selecionada, deve-se exibir a mensagem "Digite o path do arquivo JSON a ser importado:";

-   Caso a opção `4` seja selecionada, deve-se exibir a mensagem "Digite o nome do arquivo JSON a ser exportado:";

-   Caso a opção `5` seja selecionada, deve-se exibir a mensagem "Digite a quantidade de páginas a serem raspadas:";

-   Caso a opção não exista, exiba a mensagem de erro "Opção inválida" na `stderr`.

#### 13 - Ao selecionar uma opção do menu de opções e inserir as informações necessárias, a ação adequada deve ser disparada.

##### As seguintes verificações serão feitas:

-   Caso a opção `1` seja selecionada, a importação deve ser feita utilizando função `csv_importer`;

-   Caso a opção `2` seja selecionada, a exportação deve ser feita utilizando função `csv_exporter`;

-   Caso a opção `3` seja selecionada, a importação deve ser feita utilizando função `json_importer`;

-   Caso a opção `4` seja selecionada, exportação deve ser feita utilizando função `json_exporter`;

-   Caso a opção `5` seja selecionada, a raspagem deve ser feita utilizando função `scrape`;

-   Caso a opção `6` seja selecionada, deve-se encerrar a execução do script (dica: verifique o `exit code`);

-   Após finalizar a execução de uma ação, deve-se encerrar a execução do script (dica: verifique o `exit code`).

### Pacote `tech_news_app`

#### 14 - Crie um módulo `news_app_menu` que deve ser utilizado como um menu de opções, em que cada opção pede as informações necessárias disparar uma ação. O texto exibido pelo menu deve ser exatamente:

**Dica**: Utilize o `__main__`.

```md
Selecione uma das opções a seguir:

1 - Buscar notícias por título;
2 - Buscar notícias por data;
3 - Buscar notícias por fonte;
4 - Buscar notícias por categoria;
5 - Listar top 5 notícias;
6 - Listar top 5 categorias;
7 - Sair.
```

##### As seguintes verificações serão feitas:

-   A mensagem de menu deve ser exibida corretamente;

-   Caso a opção `1` seja selecionada, deve-se exibir a mensagem "Digite o título:";

-   Caso a opção `2` seja selecionada, deve-se exibir a mensagem "Digite a data:";

-   Caso a opção `3` seja selecionada, deve-se exibir a mensagem "Digite a fonte:";

-   Caso a opção `4` seja selecionada, deve-se exibir a mensagem "Digite a categoria:";

-   Caso a opção não exista, exiba a mensagem de erro "Opção inválida" na `stderr`.

#### 15 - Ao selecionar uma opção do menu de opções e inserir as informações necessárias, a ação adequada deve ser disparada e seu resultado deve ser exibido.

##### As seguintes verificações serão feitas:

-   Caso a opção `1` seja selecionada, a importação deve ser feita utilizando a função `search_by_title` e seu resultado deve ser impresso em tela;

-   Caso a opção `2` seja selecionada, a exportação deve ser feita utilizando a função `search_by_date` e seu resultado deve ser impresso em tela;

-   Caso a opção `3` seja selecionada, a importação deve ser feita utilizando a função `search_by_source` e seu resultado deve ser impresso em tela;

-   Caso a opção `4` seja selecionada, a exportação deve ser feita utilizando a função `search_by_category` e seu resultado deve ser impresso em tela;

-   Caso a opção `5` seja selecionada, a raspagem deve ser feita utilizando a função `top_5_news` e seu resultado deve ser impresso em tela;

-   Caso a opção `6` seja selecionada, a raspagem deve ser feita utilizando a função `top_5_categories` e seu resultado deve ser impresso em tela;

-   Caso a opção `7` seja selecionada, deve-se encerrar a execução do script.

## Requisitos extras:

⚠️ Requisitos não serão avaliados ⚠️

### Pacote `tech_news_data_collector`

#### 16 - A cobertura de testes unitários do pacote deve ser de no mínimo 90%.

##### As seguintes verificações serão feitas:

-   Todos os testes que envolvem mensagens na saída padrão ou de erro, devem ter sua saída redirecionada para _Fakes_ com `StringIO`;

-   Todos os testes que envolvem manipulação de arquivos criam _Fakes_ com `StringIO`;

-   Todas as requisições externas utilizam _Mocks_;

-   A cobertura de testes é de no mínimo 90%.

### Pacote `tech_news_app`

#### 17 - A cobertura de testes unitários do pacote deve ser de no mínimo 90%.

---

